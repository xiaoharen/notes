# 概述

## 因特网概述

1. 网络,互联网,因特网

2. 因特网发展的三个阶段

3. 因特网的标准化工作

4. 因特网的组成
   - 按功能区分



## 三种交换方式

1. 电路交换
2. 报文交换
3. 分组交换



## 计算机网络的定义和分类

1. 定义

   1. 精确定义尚未统一

   2. 简单定义:一些互相连接的,自治的计算机的集合.
   3. 较好的定义:

2. 分类

   1. 按交换技术:
      1. 三种交换技术

   2. 按使用者:
      1. 公用网
      2. 专用网
   3. 按传输介质
      1. 有线网络
      2. 无线网络
   4. 按覆盖范围
      1. 广域网WAN
      2. 城域网MAN
      3. 局域网LAN
      4. 个域网PAN
   5. 按拓扑结构分类
      1. 总线型
      2. 星型
      3. 环形
      4. 网状型

   

## 计算机网络的性能指标

1. 数据量
   单位:比特,字节(8 bit = 1 Byte)

2. 速率
   单位:bit/s(b/s,bps)

   **注意**:速率中K,M,G...的换算是相差10的三次方;数据量中是2的10次方,也就是1024

<img src='images\1.png' height=400>

1. 带宽:最大传输速率
2. 吞吐量
3. 时延
   1. 发送时延
   2. 传输时延
   3. 处理时延(一般不方便计算)

<img src='images\2.png' height=400>

4. 时延带宽积

   <img src='images\3.png' height=400>

5. 利用率

   <img src='images\4.png' height=400>

6. 丢包率

   丢包:传输过程中数据丢失

   丢包主要有两种情况:

   1. 传输过程中出现**误码**,被结点丢弃
   2. 数据抵达的分组交换机队列已满,数据被丢弃;在通信量较大时可能造成网络拥塞

   因此丢包率反应了网络的拥塞情况



## 计算机网络体系结构

<img src='images\8.png' height=400>



<img src='images\9.png' height=400>



<img src='images\5.png' height=400>



<img src='images\6.png' height=400>



<img src='images\7.png' height=400>



## 补充

**体系结构**

TCP/IP 参考模型的网络层提供的是 无连接不可靠的数据报服务

TCP/IP 体系结构中,直接为ICMP提供服务的协议是 IP

POP3协议接收邮件时,使用的传输层服务类型是 有连接可靠的数据传输服务

TCP/IP 体系结构的网络接口层对应OSI体系结构的 物理层和数据链路层

TCP/IP 协议族的核心协议是IP

**时延相关**

总时延计算 = 发送时延 + 传播时延 (处理时延一般忽略不计)

发送时延 = 数据量/发送速率

传播时延 = 距离/传播速率

**分组交换时延的计算**

相当于在一个分组的总时延的基础上加上剩余各分组的发送时延

<img src='images\10.png' height=400>



# 物理层

<img src='images\15.png' height=400>

## 传输媒体

1. 导引型传输媒体
   1. 同轴电缆
   2. 双绞线
   3. 光纤
   4. 电力线
2. 非导引型传输媒体
   1. 无线电波
   2. 微波
   3. 红外线
   4. 可见光



## 传输方式

一:

- 串行传输

  用于远距离传输(如计算机网络)

- 并行传输

  计算机内部(如CPU与内存通过总线进行传输)

二:

- 同步传输

- 异步传输

三:

- 单向通信(单工)
- 双向交替通信(半双工)
- 双向同时通信(全双工)



## 编码与调制

<img src='images\11.png' height=400>



**码元**:用来表示0或1的一段特定波形

**基本编码**

不归零

归零

曼切斯特

差分曼切斯特:码元开始与上一个码元结束波形不同表示0,相同表示1

<img src='images\18.png' height=400>

**基本调制**

<img src='images\13.png' height=400>

**混合调制**



## 信道的极限容量

<img src='images\14.png' height=400>

求极限数据传输速率: 

- 奈氏准则
  - 极限数据传输速率 = 最高码元传输速率 x 每个码元可携带的比特数量(即需要多少位比特来表示不同的码元)
- 香农公式
  - 如图(注意:公式中的$\frac{S}{N}$要经过题目给出的信噪比,图中右上角公式换算得到) 

<img src='images\16.png' height=400>

<img src='images\17.png' height=400>



# 数据链路层

## 封装成帧

帧定界

透明传输

MTU(最大传输单元,即帧的数据部分的最大长度)

## 差错检验

(比特差错检验)

奇偶校验: 误检率高

循环冗余校验(CRC): 只能检错,无法纠正

<img src='images\19.png' height=400>

<img src='images\20.png' height=400>



## 可靠传输

就是传输过程中会检测传输是否有误,有误则采取措施保证接受方收到数据(比如传输过程中产生误码,则重发)

可靠传输服务不仅局限于数据链路层,其它层也有



**停止-等待协议(SW)**

<img src='images\21.png' height=500>



**退回N帧协议(GBN)**

- 采用滑动窗口的模式,按给定比特数对发送数据进行分组编号
- 发送方可以发送一组数据,发送的数据组保持一定长度,左边的单位数据被接收后窗口往右滑动

<img src='images\22.png' height=200 width="1500">

- 接收方每次只能按序接收一个单位数据,接收成功后会返回对应编号的ACK
- 返回一个ACK,则表示这组数据中,该ACK编号前的单位数据都成功接收(如图,若返回ACK序号为3,表示0,1,2,3下标的数据都已经成功接收,即使前面数据对应的ACK没返回也没关系)(累积确认)
- 如果有一个数据出现错误,则该数据编号后的数据都不会接收,该数据编号后的数据都需重发(如图,若下标为2的数据出现错误,则2,3,4都得重发)
- 若分组长度为1,则此时GBN相当于SW
- 分组长度不能占满构成分组的比特,否则将无法分辨



**选择重传协议(SR)**

- 采用滑动窗口的模式,按给定比特数(x)对发送数据进行分组编号,设滑动窗口编号周期为W,W为2的x次方
- 发送方分组长度不能超过W-2
- 接收方分组长度不能超过发送方
- 窗口最左端的单位数据完成接收后窗口才能向右移动
- 接收方返回的每个ACK与每个数据一一对应,没有返回则表示数据传输出错



## 点对点协议(PPP)

可以理解为对数据链路层的主要任务(封装成帧,差错检验等)采取的方法进行规定

## 媒体接入控制

### 静态划分信道(信道复用)

1. 频分复用

   一个信道内部分成多个频道供使用,一个线路对应一个频道

2. 时分复用

   每条线路用一定时间,大家换着用

3. 波分复用

   光纤
   光转换器把输入的一系列光转换合成进行传输,然后再通过光转换器分解还原成原来的每种光

4. 码分复用

   每条线路被指定一个唯一的码片序列,以此来区别各线路发送的数据

   如果线路要发送比特1,则发送自己的码片序列
   如果线路要发送比特0,则发送自己的码片序列的反码

   每两条线路的规格化内积为0 (二进制的0换成-1,把两条线路二进制对应位相乘再除以位数)

   设一条线路码片序列为S,另一条为T

   <img src='images\24.png' height=50 width="1500">

   

   <img src='images\23.png' height=200 width="1500">

   

   接收时,对接收到的码片序列和求各自的规格化内积,即可得知对应线路发送的数据

   <img src='images\25.png' height=400 width="1500">



### 动态接入控制

#### 随机接入

1. CSMA/CD协议(Carrier Sense Multiple Access/Collision Detectio)(载波监听多址接入/碰撞检测)

   最小帧长度:64字节(512比特)

   - 帧长度不能太小,以利于碰撞检测,因此规定最小帧长度(太短了一下就过去了,不好检测呀)
   - 若发送的数据过少,需加入填充字节,以满足最小帧长度

   最大帧长度:

   - 以太网V2的MAC帧:1518字节
   - 插入VLAN标记后的802.1Q帧:1522

   极限信道利用率:不考虑碰撞发生退避

   - 发送时延/(发送时延+传播时延)

   

   1. 多址接入

      多个站点连接在一条总线上,竞争使用总线

   2. 载波监听

      每个站点在发送帧之前先要检测一下总线上是否有其它站点在发送帧

   3. 碰撞检测

      每个站点边发送帧边监听是否发生碰撞,若检测到碰撞,会原地返回碰撞信号,接收到碰撞信号的站点会等待一个随机时间再重新发送帧

      争用期(碰撞窗口):
      端到端的往返时间(两倍的传播时延)

      设争用期为t,则碰撞检测最长时间为2t,最短为t

      最长:一端A发送数据无限接近另一端B时,另一端发送数据,此时发生碰撞,此时从发送数据开始,A端接收到碰撞信号的时间为发送数据的时间+碰撞信号返回的时间,即t + t = 2t

      最短:A,B两端同时发送数据,到总线长度一半时发生碰撞,然后同时返回,此时A,B两端收到碰撞信号的时间为t/2 + t/2 = t

      退避时间 = 争用期 x 随机数
   
2. CSMA/CA协议(Carrier Sense Multiple Access/Collision Avoidance)(载波监听多址接入/碰撞避免)

   <img src='images\26.png' height=500 width="1500">



## MAC地址,IP地址,ARP协议

1. MAC(Media Access Control)

   <img src='images\27.png' height=600 width="1500">

2. IP(Internet Protocol Access)

   <img src='images\28.png' height=600 width="1500">

3. ARP协议

   通过地址解析协议ARP来获取IP地址对应的MAC地址

   每台主机上有一个ARP高速缓存表,上面有缓存有一些IP地址对应的MAC地址

   查找一个MAC地址时,若缓存表中没有,则主机会以广播的形式发送ARP请求报文(封装在MAC帧中),以获取相应MAC地址并并记录在缓存表中

   ARP不能跨网络使用,也就是说主机A要想获取到不不同网络下的主机B的MAC地址,需要通过多个网络.



## 集线器和交换机的区别

- 集线器在物理层,交换机在数据链路层,路由器在网络层

- 集线器发送数据是广播的,而交换机是一对一的
- 一台主机连接交换机的一个接口,主机发送数据时,交换机的根据内部的帧交换表选择要MAC地址对应的接口号
- 帧交换表中如果没有对应MAC地址对应的端口号,交换机会把当前数据转发到所有端口,等正确的端口返回ACK后记录下对应端口号



## 以太网交换机的生成树协议STP

- 在以太网交换机使用冗余链路提高网络可靠性时,用生成树算法STA计算出哪些链路可以先关闭掉,防止形成环路,等要用的时候再用
- 冗余链路:在可以直接或间接到达的两个交换机中添加链路,相关链路故障后还有备用链路



## 虚拟局域网VLAN

可以隔离广播区域,防止广播风暴

实现:

- 对MAC帧进行扩展,加入VLAN标记片段,用来区分不同帧传输在哪一个VLAN
- 对交换机端口进行扩展,端口分为Access,Trunk,Hybrid三种,并对每个端口标记相应的VLAN
- 端口类型:
  - Access:连接计算机
  - Trunk:连接交换机或路由器
  - Hybrid:可以连接计算机,也可以连接交换机或路由器



# 网络层

## IPv4

### 分类编址的IPv4

<img src='images\29.png' height=600 width="1500">

### 划分子网的IPv4

子网掩码

- 用来区分子网
- 32比特
- 把子网掩码中未满255的转换成2进制,有几个1就表示原网络中主机号前几位用来表示子网
- 子网掩码中1和0是连续的,1的个数表示网络位数,0的个数表示主机位数

### 无分类的IPv4

在ip地址后面加上/n,n表示子网掩码有多少个1,而子网掩码中的1表示网络位数

### 定长和变长子网掩码

假如给定一个网络xxx.xxx.xxx.xxx/24 , 用来分配网络

定长:它下面的子网对应的子网掩码都是/24

变长:它下面的子网对应的子网掩码可以增加,比如变成/26



## 一系列相关协议



# 运输层

## TCP

### TCP与UDP的区别

### 流量控制

### 拥塞控制

ssthresh:慢启动阈值

- 慢开始

  拥塞窗口

- 拥塞避免

- 快重传

- 快恢复

### 超时重传时间的选择

# 应用层

